<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: path.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: path.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Extended version of the standard `path` module.
 * @module jsdoc/path
 */
'use strict';

var env = require('jsdoc/env');
var fs = require('fs');
var path = require('path');

function prefixReducer(previousPath, current) {
    var currentPath = [];

    // if previousPath is defined, but has zero length, there's no common prefix; move along
    if (previousPath &amp;&amp; !previousPath.length) {
        return currentPath;
    }

    currentPath = path.resolve(env.pwd, current).split(path.sep) || [];

    if (previousPath &amp;&amp; currentPath.length) {
        // remove chunks that exceed the previous path's length
        currentPath = currentPath.slice(0, previousPath.length);

        // if a chunk doesn't match the previous path, remove everything from that chunk on
        for (var i = 0, l = currentPath.length; i &lt; l; i++) {
            if (currentPath[i] !== previousPath[i]) {
                currentPath.splice(i, currentPath.length - i);
                break;
            }
        }
    }

    return currentPath;
}

/**
 * Find the common prefix for an array of paths. If there is a common prefix, a trailing separator
 * is appended to the prefix. Relative paths are resolved relative to the current working directory.
 *
 * For example, assuming that the current working directory is `/Users/jsdoc`:
 *
 * + For the single path `foo/bar/baz/qux.js`, the common prefix is `foo/bar/baz/`.
 * + For paths `foo/bar/baz/qux.js`, `foo/bar/baz/quux.js`, and `foo/bar/baz.js`, the common prefix
 * is `/Users/jsdoc/foo/bar/`.
 * + For paths `../jsdoc/foo/bar/baz/qux/quux/test.js`, `/Users/jsdoc/foo/bar/bazzy.js`, and
 * `../../Users/jsdoc/foo/bar/foobar.js`, the common prefix is `/Users/jsdoc/foo/bar/`.
 * + For paths `foo/bar/baz/qux.js` and `../../Library/foo/bar/baz.js`, there is no common prefix,
 * and an empty string is returned.
 *
 * @param {Array.&lt;string>} paths - The paths to search for a common prefix.
 * @return {string} The common prefix, or an empty string if there is no common prefix.
 */
exports.commonPrefix = function(paths) {
    var segments;

    var prefix = '';

    paths = paths || [];

    // if there's only one path, its resolved dirname (plus a trailing slash) is the common prefix
    if (paths.length === 1) {
        prefix = path.resolve(env.pwd, paths[0]);
        if ( path.extname(prefix) ) {
            prefix = path.dirname(prefix);
        }

        prefix += path.sep;
    }
    else {
        segments = paths.reduce(prefixReducer, undefined) || [];

        // if there's anything left (other than a placeholder for a leading slash), add a
        // placeholder for a trailing slash
        if ( segments.length &amp;&amp; (segments.length > 1 || segments[0] !== '') ) {
            segments.push('');
        }

        prefix = segments.join(path.sep);
    }

    return prefix;
};

/**
 * Retrieve the fully qualified path to the requested resource.
 *
 * If the resource path is specified as a relative path, JSDoc searches for the resource in the
 * following locations, in this order:
 *
 * 1. The current working directory
 * 2. The directory where the JSDoc configuration file is located
 * 3. The JSDoc directory
 * 4. Anyplace where `require()` can find the resource (for example, in your project's
 * `node_modules` directory)
 *
 * If the resource path is specified as a fully qualified path, JSDoc searches for the resource in
 * the following locations, in this order:
 *
 * 1. The resource path
 * 2. Anyplace where `require()` can find the resource (for example, in your project's
 * `node_modules` directory)
 *
 * @param {string} filepath - The path to the requested resource. May be an absolute path; a path
 * relative to the JSDoc directory; or a path relative to the current working directory.
 * @param {string} [filename] - The filename of the requested resource.
 * @return {string} The fully qualified path to the requested resource. Includes the filename if one
 * was provided.
 */
exports.getResourcePath = function(filepath, filename) {
    var result = null;
    var searchDirs = [env.pwd, path.dirname(env.opts.configure || ''), env.dirname];

    function exists(p) {
        try {
            fs.statSync(p);

            return true;
        }
        catch (e) {
            return false;
        }
    }

    function resolve(p) {
        try {
            return require.resolve(p);
        }
        catch (e) {
            return null;
        }
    }

    function find(p) {
        // does the requested path exist?
        if ( exists(p) ) {
            result = p;
        }
        else {
            // can `require()` find the requested path?
            result = resolve(p);
        }

        return Boolean(result);
    }

    filepath = path.join(filepath, filename || '');

    // is the filepath absolute? if so, just use it
    if ( path.isAbsolute(filepath) ) {
        find(filepath);
    }
    else {
        searchDirs.some(function(searchDir) {
            if (searchDir) {
                return find( path.resolve(path.join(searchDir, filepath)) );
            }
            else {
                return false;
            }
        });
    }

    // if we still haven't found the resource, maybe it's an installed module
    if (!result) {
        result = resolve(filepath);
    }

    return result;
};

Object.keys(path).forEach(function(member) {
    exports[member] = path[member];
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-jsdoc_app.html">jsdoc/app</a></li><li><a href="module-jsdoc_augment.html">jsdoc/augment</a></li><li><a href="module-jsdoc_borrow.html">jsdoc/borrow</a></li><li><a href="module-jsdoc_config.html">jsdoc/config</a></li><li><a href="module-jsdoc_doclet.html">jsdoc/doclet</a></li><li><a href="module-jsdoc_env.html">jsdoc/env</a></li><li><a href="module-jsdoc_fs.html">jsdoc/fs</a></li><li><a href="module-jsdoc_name.html">jsdoc/name</a></li><li><a href="module-jsdoc_package.html">jsdoc/package</a></li><li><a href="module-jsdoc_path.html">jsdoc/path</a></li><li><a href="module-jsdoc_plugins.html">jsdoc/plugins</a></li><li><a href="module-jsdoc_readme.html">jsdoc/readme</a></li><li><a href="module-jsdoc_schema.html">jsdoc/schema</a></li><li><a href="module-jsdoc_tag.html">jsdoc/tag</a></li><li><a href="module-jsdoc_template.html">jsdoc/template</a></li><li><a href="module-jsdoc_tutorial.html">jsdoc/tutorial</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-jsdoc_app.jsdoc.html">jsdoc</a></li><li><a href="module-jsdoc_doclet.Doclet_setMeta_meta.html">meta</a></li><li><a href="module-jsdoc_doclet.Doclet_setMeta_meta.code.html">code</a></li></ul><h3>Classes</h3><ul><li><a href="module-jsdoc_config-Config.html">Config</a></li><li><a href="module-jsdoc_doclet.Doclet.html">Doclet</a></li><li><a href="module-jsdoc_package.Package.html">Package</a></li><li><a href="module-jsdoc_readme-ReadMe.html">ReadMe</a></li><li><a href="module-jsdoc_tag.Tag.html">Tag</a></li><li><a href="module-jsdoc_template.Template.html">Template</a></li><li><a href="module-jsdoc_tutorial.RootTutorial.html">RootTutorial</a></li><li><a href="module-jsdoc_tutorial.Tutorial.html">Tutorial</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.0-dev</a> on Fri Sep 14 2018 15:10:37 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
